# 

# gotran file generated by cellml2gotran from Downloads/paci_hyttinen_aaltosetala_severi_atrialVersion.cellml

parameters("Electric potentials",
           PkNa = 0.03)

parameters("i_Na",
           g_Na = ScalarParam(6646.185, unit="S*F**-1"))

states("i_Na", "m gate",
       m = 0.141183142078492)

states("i_Na", "h gate",
       h = 0.642108593994587)

states("i_Na", "j gate",
       j = 0.173566329483423)

parameters("i_CaL",
           g_CaL = ScalarParam(8.635702e-5, unit="m**3*F**-1*s**-1"))

states("i_CaL", "d gate",
       d = 0.000127632520741878)

states("i_CaL", "F1 gate",
       f1 = 0.98038400433601)

states("i_CaL", "F2 gate",
       f2 = 0.999953006710394)

states("i_CaL", "FCa gate",
       fCa = 0.997346890768643)

parameters("i_CaL", "FCa gate",
           tau_fCa = ScalarParam(0.002, unit="s"))

parameters("i_Kr",
           g_Kr = ScalarParam(29.8667, unit="S*F**-1"))

states("i_Kr", "Xr1 gate",
       Xr1 = 0.0257889110986083)

parameters("i_Kr", "Xr1 gate",
           L0 = 0.025,
           Q = 2.3)

states("i_Kr", "Xr2 gate",
       Xr2 = 0.405046678739985)

parameters("i_Ks",
           g_Ks = ScalarParam(2.041, unit="S*F**-1"))

states("i_Ks", "Xs gate",
       Xs = 0.0447460799149437)

parameters("i_K1",
           g_K1 = ScalarParam(19.1925, unit="S*F**-1"))

parameters("i_f",
           g_f = ScalarParam(30.10312, unit="S*F**-1"),
           E_f = ScalarParam(-0.017, unit="V"))

states("i_f", "Xf gate",
       Xf = 0.0607988713874682)

parameters("i_b Na",
           g_b_Na = ScalarParam(0.9, unit="S*F**-1"))

parameters("i_b Ca",
           g_b_Ca = ScalarParam(0.69264, unit="S*F**-1"))

parameters("i_NaK",
           Km_K = ScalarParam(1.0, unit="mM"),
           Km_Na = ScalarParam(40.0, unit="mM"),
           PNaK = ScalarParam(1.4731392, unit="A*F**-1"))

parameters("i_NaCa",
           kNaCa = ScalarParam(2450.0, unit="A*F**-1"),
           alpha = 2.8571432,
           gamma = 0.35,
           Ksat = 0.1,
           KmCa = ScalarParam(1.38, unit="mM"),
           KmNai = ScalarParam(87.5, unit="mM"))

parameters("i_PCa",
           g_PCa = ScalarParam(0.4125, unit="A*F**-1"),
           KPCa = ScalarParam(0.0005, unit="mM"))

parameters("i_to",
           g_to = ScalarParam(59.8077, unit="S*F**-1"))

states("i_to", "q gate",
       q = 0.776163826643278)

states("i_to", "r gate",
       r = 0.000503296941001262)

parameters("Model parameters",
           Cao = ScalarParam(1.8, unit="mM"),
           Nao = ScalarParam(151.0, unit="mM"),
           Ki = ScalarParam(150.0, unit="mM"),
           Ko = ScalarParam(5.4, unit="mM"),
           Cm = ScalarParam(7.86671e-11, unit="F"),
           Vc = ScalarParam(7012.0, unit="um**3"),
           V_SR = ScalarParam(465.2, unit="um**3"),
           R = ScalarParam(8.314472, unit="J*mole**-1*K**-1"),
           T = ScalarParam(310.0, unit="K"),
           F = ScalarParam(96485.3415, unit="C*mole**-1"))

states("Sodium dynamics",
       Nai = ScalarParam(14.4424010544424, unit="mM"))

states("Calcium dynamics",
       g = 1.0,
       Cai = ScalarParam(4.49232909234503e-5, unit="mM"),
       Ca_SR = ScalarParam(0.149980051221604, unit="mM"))

parameters("Calcium dynamics",
           a_rel = ScalarParam(16.464, unit="mM*s**-1"),
           b_rel = ScalarParam(0.25, unit="mM"),
           c_rel = ScalarParam(8.232, unit="mM*s**-1"),
           tau_g = ScalarParam(0.002, unit="s"),
           Kup = ScalarParam(0.00025, unit="mM"),
           Buf_C = ScalarParam(0.25, unit="mM"),
           Buf_SR = ScalarParam(10.0, unit="mM"),
           Kbuf_C = ScalarParam(0.001, unit="mM"),
           Kbuf_SR = ScalarParam(0.3, unit="mM"),
           VmaxUp = ScalarParam(0.22, unit="mM*s**-1"),
           V_leak = ScalarParam(0.00044444, unit="s**-1"))

states("Membrane",
       V = ScalarParam(-0.068733823452164, unit="V"))

expressions("Electric potentials")
E_Na = R*T/F*log(Nao/Nai) # V
E_K = R*T/F*log(Ko/Ki) # V
E_Ks = R*T/F*log((Ko + PkNa*Nao)/(Ki + PkNa*Nai)) # V
E_Ca = 0.5*R*T/F*log(Cao/Cai) # V

expressions("i_Na")
i_Na = g_Na*m**3*h*j*(V - E_Na) # A*F**-1

expressions("i_Na", "m gate")
m_inf = 1/(1 + exp((-V*1000 - 34.1)/5.9))**(1.0/3)
alpha_m = 1/(1 + exp((-V*1000 - 60)/5.0))
beta_m = 0.1/(1 + exp((V*1000 + 35)/5.0)) + 0.1/(1 + exp((V*1000 - 50)/200))
tau_m = 1*alpha_m*beta_m/1000.0 # s
dm_dt = (m_inf - m)/tau_m

expressions("i_Na", "h gate")
h_inf = 1.0/sqrt(1 + exp((V*1000 + 72.1)/5.7))
alpha_h = Conditional(Lt(V, -0.04), 0.057*exp(-(V*1000 + 80)/6.8), 0)
beta_h = Conditional(Lt(V, -0.04), 2.7*exp(0.079*V*1000) + 3.1*10**5*exp(0.3485*V*1000), 0.77/(0.13*(1 + exp((V*1000 + 10.66)/-11.1))))
tau_h = Conditional(Lt(V, -0.04), 1.5/((alpha_h + beta_h)*1000), 2.542/1000) # s
dh_dt = (h_inf - h)/tau_h

expressions("i_Na", "j gate")
j_inf = 1/sqrt(1 + exp((V*1000 + 72.1)/5.7))
alpha_j = Conditional(Lt(V, -0.04), (-25428.0*exp(0.2444*V*1000) - 6.948*10**-6*exp(-0.04391*V*1000))*(V*1000 + 37.78)/(1 + exp(0.311*(V*1000 + 79.23))), 0)
beta_j = Conditional(Lt(V, -0.04), 0.02424*exp(-0.01052*V*1000)/(1 + exp(-0.1378*(V*1000 + 40.14))), 0.6*exp(0.057*V*1000)/(1 + exp(-0.1*(V*1000 + 32.0))))
tau_j = 7.0/((alpha_j + beta_j)*1000) # s
dj_dt = (j_inf - j)/tau_j

expressions("i_CaL")
i_CaL = g_CaL*4*V*F**2.0/(R*T)*(Cai*exp(2*V*F/(R*T)) - 0.341*Cao)/(exp(2*V*F/(R*T)) - 1)*d*f1*f2*fCa # A*F**-1

expressions("i_CaL", "d gate")
d_infinity = 1.0/(1 + exp(-(V*1000 + 5.986)/7))
alpha_d = 0.25 + 1.4/(1 + exp((-V*1000 - 35)/13))
beta_d = 1.4/(1 + exp((V*1000 + 5)/5))
gamma_d = 1.0/(1 + exp((-V*1000 + 50)/20))
tau_d = (alpha_d*beta_d + gamma_d)*1.0/1000 # s
dd_dt = (d_infinity - d)/tau_d

expressions("i_CaL", "F1 gate")
f1_inf = 1.0/(1 + exp((V*1000 + 25.226)/3))
constf1 = Conditional(Gt(f1_inf - f1, 0), 1 + 1433.0*(Cai - 50*1e-6), 1)
tau_f1 = (20 + 1102.5*exp(-((V*1000 + 27)**2/15.0)**2) + 200.0/(1 + exp((13 - V*1000)/10.0)) + 180/(1 + exp((30 + V*1000)/10.0)))*constf1/1000 # s
df1_dt = (f1_inf - f1)/tau_f1

expressions("i_CaL", "F2 gate")
f2_inf = 0.33 + 0.67/(1 + exp((V*1000 + 31.226)/4))
constf2 = 2.0
tau_f2 = (600*exp(-((V*1000 + 25)**2)/170.0) + 31/(1 + exp((25 - V*1000)/10.0)) + 16/(1 + exp((30 + V*1000)/10.0)))*constf2/1000 # s
df2_dt = (f2_inf - f2)/tau_f2

expressions("i_CaL", "FCa gate")
alpha_fCa = 1.0/(1 + (Cai/0.0006)**8)
beta_fCa = 0.1/(1 + exp((Cai - 0.0009)/0.0001))
gamma_fCa = 0.3/(1 + exp((Cai - 0.00075)/0.0008))
fCa_inf = (alpha_fCa + beta_fCa + gamma_fCa)/1.3156
constfCa = Conditional(And(Gt(V, -0.06), Gt(fCa_inf, fCa), ), 0, 1)
dfCa_dt = constfCa*(fCa_inf - fCa)/tau_fCa

expressions("i_Kr")
i_Kr = g_Kr*(V - E_K)*Xr1*Xr2*sqrt(Ko/5.4) # A*F**-1

expressions("i_Kr", "Xr1 gate")
V_half = 1000*(-R*T/(F*Q)*log((1 + Cao/2.6)**4/(L0*(1 + Cao/0.58)**4)) - 0.019) # mV
Xr1_inf = 1/(1 + exp((V_half - V*1000)/4.9))
alpha_Xr1 = 450.0/(1 + exp((-45 - V*1000)/10))
beta_Xr1 = 6.0/(1 + exp((30 + V*1000)/11.5))
tau_Xr1 = 1.0*alpha_Xr1*beta_Xr1/1000 # s
dXr1_dt = (Xr1_inf - Xr1)/tau_Xr1

expressions("i_Kr", "Xr2 gate")
Xr2_infinity = 1.0/(1 + exp((V*1000 + 88)/50))
alpha_Xr2 = 3.0/(1 + exp((-60 - V*1000)/20))
beta_Xr2 = 1.12/(1 + exp((-60 + V*1000)/20))
tau_Xr2 = 1.0*alpha_Xr2*beta_Xr2/1000 # s
dXr2_dt = (Xr2_infinity - Xr2)/tau_Xr2

expressions("i_Ks")
i_Ks = g_Ks*(V - E_Ks)*Xs**2*(1 + 0.6/(1 + (3.8*0.00001/Cai)**1.4)) # A*F**-1

expressions("i_Ks", "Xs gate")
Xs_infinity = 1.0/(1 + exp((-V*1000 - 20)/16))
alpha_Xs = 1100.0/sqrt(1 + exp((-10 - V*1000)/6))
beta_Xs = 1.0/(1 + exp((-60 + V*1000)/20))
tau_Xs = 1.0*alpha_Xs*beta_Xs/1000 # s
dXs_dt = (Xs_infinity - Xs)/tau_Xs

expressions("i_K1")
alpha_K1 = 3.91/(1 + exp(0.5942*(V*1000 - E_K*1000 - 200)))
beta_K1 = (-1.509*exp(0.0002*(V*1000 - E_K*1000 + 100)) + exp(0.5886*(V*1000 - E_K*1000 - 10)))/(1 + exp(0.4547*(V*1000 - E_K*1000)))
XK1_inf = alpha_K1/(alpha_K1 + beta_K1)
i_K1 = g_K1*XK1_inf*(V - E_K)*sqrt(Ko/5.4) # A*F**-1

expressions("i_f")
i_f = g_f*Xf*(V - E_f) # A*F**-1

expressions("i_f", "Xf gate")
Xf_infinity = 1.0/(1 + exp((V*1000 + 77.85)/5))
tau_Xf = 1900.0/(1 + exp((V*1000 + 15)/10))/1000 # s
dXf_dt = (Xf_infinity - Xf)/tau_Xf

expressions("i_b Na")
i_b_Na = g_b_Na*(V - E_Na) # A*F**-1

expressions("i_b Ca")
i_b_Ca = g_b_Ca*(V - E_Ca) # A*F**-1

expressions("i_NaK")
i_NaK = PNaK*Ko/(Ko + Km_K)*Nai/(Nai + Km_Na)/(1 + 0.1245*exp(-0.1*V*F/(R*T)) + 0.0353*exp(-V*F/(R*T))) # A*F**-1

expressions("i_NaCa")
i_NaCa = kNaCa*(exp(gamma*V*F/(R*T))*Nai**3*Cao - exp((gamma - 1)*V*F/(R*T))*Nao**3*Cai*alpha)/((KmNai**3 + Nao**3)*(KmCa + Cao)*(1 + Ksat*exp((gamma - 1)*V*F/(R*T)))) # A*F**-1

expressions("i_PCa")
i_PCa = g_PCa*Cai/(Cai + KPCa) # A*F**-1

expressions("i_to")
i_to = g_to*(V - E_K)*q*r # A*F**-1

expressions("i_to", "q gate")
q_inf = 1.0/(1 + exp((V*1000 + 53)/13))
tau_q = (6.06 + 39.102/(0.57*exp(-0.08*(V*1000 + 44)) + 0.065*exp(0.1*(V*1000 + 45.93))))/1000 # s
dq_dt = (q_inf - q)/tau_q

expressions("i_to", "r gate")
r_inf = 1.0/(1 + exp(-(V*1000 - 22.3)/18.75))
tau_r = (2.75352 + 14.40516/(1.037*exp(0.09*(V*1000 + 30.61)) + 0.369*exp(-0.12*(V*1000 + 23.84))))/1000 # s
dr_dt = (r_inf - r)/tau_r

expressions("Sodium dynamics")
dNai_dt = -Cm*(i_Na + i_b_Na + 3*i_NaK + 3*i_NaCa)/(F*Vc*1e-18)

expressions("Calcium dynamics")
i_rel = (c_rel + a_rel*Ca_SR**2/(b_rel**2 + Ca_SR**2))*d*g*0.0556 # mM*s**-1
i_up = VmaxUp/(1 + Kup**2/Cai**2) # mM*s**-1
i_leak = (Ca_SR - Cai)*V_leak # mM*s**-1
g_inf = Conditional(Le(Cai, 0.00035), 1/(1 + (Cai/0.00035)**6), 1/(1 + (Cai/0.00035)**16))
const2 = Conditional(And(Gt(g_inf, g), Gt(V, -0.06), ), 0, 1)
dg_dt = const2*(g_inf - g)/tau_g
Cai_bufc = 1.0/(1 + Buf_C*Kbuf_C/(Cai + Kbuf_C)**2)
Ca_SR_bufSR = 1/(1 + Buf_SR*Kbuf_SR/(Ca_SR + Kbuf_SR)**2)
dCai_dt = Cai_bufc*(i_leak - i_up + i_rel - (i_CaL + i_b_Ca + i_PCa - 2*i_NaCa)*Cm/(2*Vc*F*1e-18))
dCa_SR_dt = Ca_SR_bufSR*Vc/V_SR*(i_up - (i_rel + i_leak))

expressions("Membrane")
dV_dt = -(i_K1 + i_to + i_Kr + i_Ks + i_CaL + i_NaK + i_Na + i_NaCa + i_PCa + i_f + i_b_Na + i_b_Ca)

