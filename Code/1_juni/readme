We have three different domains: a 3mm strip, a 12 mm strip and a 12x12 mm square domain. All files are named accordingly. In this file, we take the 12mm strip as an example.

1) create_initial_conditions_12mm_strip.py can be used to create an h5 file: initial_conditions_3mm_strip.h5. The model is run for 800s.

2a) Thereafter, create_observations_12mm_strip.py must be used to create synthetic observations: observed_v_A_B_C_D_E_12mm_strip.h5, observed_cai_A_B_C_D_E_12mm_strip.h5, and observed_times_A_B_C_D_E_12mm_strip.txt. Here, A,B,C,D en E stand for the value of the factor we multiply sigma_t, g_Na, g_Kr, g_K1 and g_CaL with respectively. Those values should be given as arguments and should lie in the range [0.5-1.5].
2b) Alternatively, create_noisy_observations_12mm_strip.py can be used to create noisy observations. The noise percentages can be given as arguments. The output files contain the noise percentages in their names.

3) inverse_3mm_strip.py solves the inverse problem. The levels of noise can be passed as arguments. The output file contains the size of the functional, its derivatives and the value of the control variables at every iteration step.
--------

The cbcbeat folder contains de Paci2013 cell models we use. 

--------

In the folder named 'extra', we included some extra code:

*) The single_cell_solve_spontaneous.py and single_cell_solve_stimulus.py solve the ventricular or atrial Paci cell model at a single point in space. 

--------

